import{c as Oe,a as Me,r as l,u as H,b as Be,j as e,P as T,d as $,e as _,f as R,g as We,h as Ve,i as ee,D as xe,k as he,l as ge,m as pe,B as C,R as fe,C as J,n as Q,o as be,p as K,q as $e,T as F,s as E,M as G,U as Xe,L as qe,t as Ye,v as oe,w as ve,E as Fe,x as Ge,y as ie,z as Je,A as Qe,F as Ke,G as Ze,H as et,I as tt}from"./index-2Tx6ThBi.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=Oe("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function st(t,r){return l.useReducer((n,o)=>r[n][o]??n,t)}var te="ScrollArea",[je,_t]=Me(te),[rt,y]=je(te),ye=l.forwardRef((t,r)=>{const{__scopeScrollArea:n,type:o="hover",dir:s,scrollHideDelay:c=600,...d}=t,[i,a]=l.useState(null),[x,m]=l.useState(null),[h,u]=l.useState(null),[g,b]=l.useState(null),[S,P]=l.useState(null),[N,L]=l.useState(0),[O,k]=l.useState(0),[I,A]=l.useState(!1),[D,p]=l.useState(!1),f=H(r,z=>a(z)),v=Be(s);return e.jsx(rt,{scope:n,type:o,dir:v,scrollHideDelay:c,scrollArea:i,viewport:x,onViewportChange:m,content:h,onContentChange:u,scrollbarX:g,onScrollbarXChange:b,scrollbarXEnabled:I,onScrollbarXEnabledChange:A,scrollbarY:S,onScrollbarYChange:P,scrollbarYEnabled:D,onScrollbarYEnabledChange:p,onCornerWidthChange:L,onCornerHeightChange:k,children:e.jsx(T.div,{dir:v,...d,ref:f,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":O+"px",...t.style}})})});ye.displayName=te;var we="ScrollAreaViewport",Se=l.forwardRef((t,r)=>{const{__scopeScrollArea:n,children:o,asChild:s,nonce:c,...d}=t,i=y(we,n),a=l.useRef(null),x=H(r,a,i.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:c}),e.jsx(T.div,{"data-radix-scroll-area-viewport":"",...d,asChild:s,ref:x,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...t.style},children:xt({asChild:s,children:o},m=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:i.onContentChange,style:{minWidth:i.scrollbarXEnabled?"fit-content":void 0},children:m}))})]})});Se.displayName=we;var w="ScrollAreaScrollbar",se=l.forwardRef((t,r)=>{const{forceMount:n,...o}=t,s=y(w,t.__scopeScrollArea),{onScrollbarXEnabledChange:c,onScrollbarYEnabledChange:d}=s,i=t.orientation==="horizontal";return l.useEffect(()=>(i?c(!0):d(!0),()=>{i?c(!1):d(!1)}),[i,c,d]),s.type==="hover"?e.jsx(nt,{...o,ref:r,forceMount:n}):s.type==="scroll"?e.jsx(at,{...o,ref:r,forceMount:n}):s.type==="auto"?e.jsx(Ne,{...o,ref:r,forceMount:n}):s.type==="always"?e.jsx(re,{...o,ref:r}):null});se.displayName=w;var nt=l.forwardRef((t,r)=>{const{forceMount:n,...o}=t,s=y(w,t.__scopeScrollArea),[c,d]=l.useState(!1);return l.useEffect(()=>{const i=s.scrollArea;let a=0;if(i){const x=()=>{window.clearTimeout(a),d(!0)},m=()=>{a=window.setTimeout(()=>d(!1),s.scrollHideDelay)};return i.addEventListener("pointerenter",x),i.addEventListener("pointerleave",m),()=>{window.clearTimeout(a),i.removeEventListener("pointerenter",x),i.removeEventListener("pointerleave",m)}}},[s.scrollArea,s.scrollHideDelay]),e.jsx($,{present:n||c,children:e.jsx(Ne,{"data-state":c?"visible":"hidden",...o,ref:r})})}),at=l.forwardRef((t,r)=>{const{forceMount:n,...o}=t,s=y(w,t.__scopeScrollArea),c=t.orientation==="horizontal",d=q(()=>a("SCROLL_END"),100),[i,a]=st("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(i==="idle"){const x=window.setTimeout(()=>a("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(x)}},[i,s.scrollHideDelay,a]),l.useEffect(()=>{const x=s.viewport,m=c?"scrollLeft":"scrollTop";if(x){let h=x[m];const u=()=>{const g=x[m];h!==g&&(a("SCROLL"),d()),h=g};return x.addEventListener("scroll",u),()=>x.removeEventListener("scroll",u)}},[s.viewport,c,a,d]),e.jsx($,{present:n||i!=="hidden",children:e.jsx(re,{"data-state":i==="hidden"?"hidden":"visible",...o,ref:r,onPointerEnter:_(t.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:_(t.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),Ne=l.forwardRef((t,r)=>{const n=y(w,t.__scopeScrollArea),{forceMount:o,...s}=t,[c,d]=l.useState(!1),i=t.orientation==="horizontal",a=q(()=>{if(n.viewport){const x=n.viewport.offsetWidth<n.viewport.scrollWidth,m=n.viewport.offsetHeight<n.viewport.scrollHeight;d(i?x:m)}},10);return U(n.viewport,a),U(n.content,a),e.jsx($,{present:o||c,children:e.jsx(re,{"data-state":c?"visible":"hidden",...s,ref:r})})}),re=l.forwardRef((t,r)=>{const{orientation:n="vertical",...o}=t,s=y(w,t.__scopeScrollArea),c=l.useRef(null),d=l.useRef(0),[i,a]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),x=Ee(i.viewport,i.content),m={...o,sizes:i,onSizesChange:a,hasThumb:x>0&&x<1,onThumbChange:u=>c.current=u,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:u=>d.current=u};function h(u,g){return ut(u,d.current,i,g)}return n==="horizontal"?e.jsx(lt,{...m,ref:r,onThumbPositionChange:()=>{if(s.viewport&&c.current){const u=s.viewport.scrollLeft,g=de(u,i,s.dir);c.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:u=>{s.viewport&&(s.viewport.scrollLeft=u)},onDragScroll:u=>{s.viewport&&(s.viewport.scrollLeft=h(u,s.dir))}}):n==="vertical"?e.jsx(ot,{...m,ref:r,onThumbPositionChange:()=>{if(s.viewport&&c.current){const u=s.viewport.scrollTop,g=de(u,i);c.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:u=>{s.viewport&&(s.viewport.scrollTop=u)},onDragScroll:u=>{s.viewport&&(s.viewport.scrollTop=h(u))}}):null}),lt=l.forwardRef((t,r)=>{const{sizes:n,onSizesChange:o,...s}=t,c=y(w,t.__scopeScrollArea),[d,i]=l.useState(),a=l.useRef(null),x=H(r,a,c.onScrollbarXChange);return l.useEffect(()=>{a.current&&i(getComputedStyle(a.current))},[a]),e.jsx(Pe,{"data-orientation":"horizontal",...s,ref:x,sizes:n,style:{bottom:0,left:c.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:c.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":X(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,h)=>{if(c.viewport){const u=c.viewport.scrollLeft+m.deltaX;t.onWheelScroll(u),Te(u,h)&&m.preventDefault()}},onResize:()=>{a.current&&c.viewport&&d&&o({content:c.viewport.scrollWidth,viewport:c.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:W(d.paddingLeft),paddingEnd:W(d.paddingRight)}})}})}),ot=l.forwardRef((t,r)=>{const{sizes:n,onSizesChange:o,...s}=t,c=y(w,t.__scopeScrollArea),[d,i]=l.useState(),a=l.useRef(null),x=H(r,a,c.onScrollbarYChange);return l.useEffect(()=>{a.current&&i(getComputedStyle(a.current))},[a]),e.jsx(Pe,{"data-orientation":"vertical",...s,ref:x,sizes:n,style:{top:0,right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":X(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,h)=>{if(c.viewport){const u=c.viewport.scrollTop+m.deltaY;t.onWheelScroll(u),Te(u,h)&&m.preventDefault()}},onResize:()=>{a.current&&c.viewport&&d&&o({content:c.viewport.scrollHeight,viewport:c.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:W(d.paddingTop),paddingEnd:W(d.paddingBottom)}})}})}),[it,Ce]=je(w),Pe=l.forwardRef((t,r)=>{const{__scopeScrollArea:n,sizes:o,hasThumb:s,onThumbChange:c,onThumbPointerUp:d,onThumbPointerDown:i,onThumbPositionChange:a,onDragScroll:x,onWheelScroll:m,onResize:h,...u}=t,g=y(w,n),[b,S]=l.useState(null),P=H(r,f=>S(f)),N=l.useRef(null),L=l.useRef(""),O=g.viewport,k=o.content-o.viewport,I=R(m),A=R(a),D=q(h,10);function p(f){if(N.current){const v=f.clientX-N.current.left,z=f.clientY-N.current.top;x({x:v,y:z})}}return l.useEffect(()=>{const f=v=>{const z=v.target;(b==null?void 0:b.contains(z))&&I(v,k)};return document.addEventListener("wheel",f,{passive:!1}),()=>document.removeEventListener("wheel",f,{passive:!1})},[O,b,k,I]),l.useEffect(A,[o,A]),U(b,D),U(g.content,D),e.jsx(it,{scope:n,scrollbar:b,hasThumb:s,onThumbChange:R(c),onThumbPointerUp:R(d),onThumbPositionChange:A,onThumbPointerDown:R(i),children:e.jsx(T.div,{...u,ref:P,style:{position:"absolute",...u.style},onPointerDown:_(t.onPointerDown,f=>{f.button===0&&(f.target.setPointerCapture(f.pointerId),N.current=b.getBoundingClientRect(),L.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),p(f))}),onPointerMove:_(t.onPointerMove,p),onPointerUp:_(t.onPointerUp,f=>{const v=f.target;v.hasPointerCapture(f.pointerId)&&v.releasePointerCapture(f.pointerId),document.body.style.webkitUserSelect=L.current,g.viewport&&(g.viewport.style.scrollBehavior=""),N.current=null})})})}),B="ScrollAreaThumb",Ae=l.forwardRef((t,r)=>{const{forceMount:n,...o}=t,s=Ce(B,t.__scopeScrollArea);return e.jsx($,{present:n||s.hasThumb,children:e.jsx(ct,{ref:r,...o})})}),ct=l.forwardRef((t,r)=>{const{__scopeScrollArea:n,style:o,...s}=t,c=y(B,n),d=Ce(B,n),{onThumbPositionChange:i}=d,a=H(r,h=>d.onThumbChange(h)),x=l.useRef(),m=q(()=>{x.current&&(x.current(),x.current=void 0)},100);return l.useEffect(()=>{const h=c.viewport;if(h){const u=()=>{if(m(),!x.current){const g=mt(h,i);x.current=g,i()}};return i(),h.addEventListener("scroll",u),()=>h.removeEventListener("scroll",u)}},[c.viewport,m,i]),e.jsx(T.div,{"data-state":d.hasThumb?"visible":"hidden",...s,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...o},onPointerDownCapture:_(t.onPointerDownCapture,h=>{const g=h.target.getBoundingClientRect(),b=h.clientX-g.left,S=h.clientY-g.top;d.onThumbPointerDown({x:b,y:S})}),onPointerUp:_(t.onPointerUp,d.onThumbPointerUp)})});Ae.displayName=B;var ne="ScrollAreaCorner",Re=l.forwardRef((t,r)=>{const n=y(ne,t.__scopeScrollArea),o=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&o?e.jsx(dt,{...t,ref:r}):null});Re.displayName=ne;var dt=l.forwardRef((t,r)=>{const{__scopeScrollArea:n,...o}=t,s=y(ne,n),[c,d]=l.useState(0),[i,a]=l.useState(0),x=!!(c&&i);return U(s.scrollbarX,()=>{var h;const m=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(m),a(m)}),U(s.scrollbarY,()=>{var h;const m=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(m),d(m)}),x?e.jsx(T.div,{...o,ref:r,style:{width:c,height:i,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function W(t){return t?parseInt(t,10):0}function Ee(t,r){const n=t/r;return isNaN(n)?0:n}function X(t){const r=Ee(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=(t.scrollbar.size-n)*r;return Math.max(o,18)}function ut(t,r,n,o="ltr"){const s=X(n),c=s/2,d=r||c,i=s-d,a=n.scrollbar.paddingStart+d,x=n.scrollbar.size-n.scrollbar.paddingEnd-i,m=n.content-n.viewport,h=o==="ltr"?[0,m]:[m*-1,0];return _e([a,x],h)(t)}function de(t,r,n="ltr"){const o=X(r),s=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,c=r.scrollbar.size-s,d=r.content-r.viewport,i=c-o,a=n==="ltr"?[0,d]:[d*-1,0],x=Ve(t,a);return _e([0,d],[0,i])(x)}function _e(t,r){return n=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const o=(r[1]-r[0])/(t[1]-t[0]);return r[0]+o*(n-t[0])}}function Te(t,r){return t>0&&t<r}var mt=(t,r=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},o=0;return function s(){const c={left:t.scrollLeft,top:t.scrollTop},d=n.left!==c.left,i=n.top!==c.top;(d||i)&&r(),n=c,o=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(o)};function q(t,r){const n=R(t),o=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(o.current),[]),l.useCallback(()=>{window.clearTimeout(o.current),o.current=window.setTimeout(n,r)},[n,r])}function U(t,r){const n=R(r);We(()=>{let o=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(o),o=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(o),s.unobserve(t)}}},[t,n])}function xt(t,r){const{asChild:n,children:o}=t;if(!n)return typeof r=="function"?r(o):r;const s=l.Children.only(o);return l.cloneElement(s,{children:typeof r=="function"?r(s.props.children):r})}var Le=ye,ht=Se,gt=Re;const Y=l.forwardRef(({className:t,children:r,...n},o)=>e.jsxs(Le,{ref:o,className:ee("relative overflow-hidden",t),...n,children:[e.jsx(ht,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(ke,{}),e.jsx(gt,{})]}));Y.displayName=Le.displayName;const ke=l.forwardRef(({className:t,orientation:r="vertical",...n},o)=>e.jsx(se,{ref:o,orientation:r,className:ee("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:e.jsx(Ae,{className:"relative flex-1 rounded-full bg-border"})}));ke.displayName=se.displayName;const pt=({call:t,open:r,onClose:n,view:o})=>{const[s,c]=l.useState(!1),[d,i]=l.useState(!1),a=l.useRef(null),x=l.useCallback(async()=>{if(t!=null&&t.recording_url){i(!0);try{const u=await(await fetch(t.recording_url)).blob(),g=window.URL.createObjectURL(u),b=document.createElement("a");b.href=g,b.download=`call-${t.id}.mp3`,document.body.appendChild(b),b.click(),window.URL.revokeObjectURL(g),document.body.removeChild(b)}catch(h){console.error("Error downloading recording:",h)}finally{i(!1)}}},[t]),m=l.useCallback(()=>{a.current&&(s?a.current.pause():a.current.play(),c(!s))},[s,a]);return l.useEffect(()=>{r||(c(!1),a.current&&(a.current.pause(),a.current.currentTime=0))},[r]),t?e.jsx(xe,{open:r,onOpenChange:n,children:e.jsxs(he,{className:"max-w-2xl max-h-[80vh]",children:[e.jsx(ge,{children:e.jsx(pe,{children:o==="transcript"?"Call Transcript":"Call Recording"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[e.jsxs("div",{children:["Phone: ",t.phone_number]}),e.jsx("div",{children:t.created_at?new Date(t.created_at).toLocaleString():"Unknown time"})]}),o==="transcript"&&t.transcript&&e.jsx(Y,{className:"h-[400px] w-full rounded-md border p-4",children:e.jsx("div",{className:"whitespace-pre-wrap font-mono text-sm",children:t.transcript})}),o==="recording"&&t.recording_url&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("audio",{ref:a,src:t.recording_url,onEnded:()=>c(!1),onPause:()=>c(!1),onPlay:()=>c(!0)}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx(C,{onClick:m,variant:"outline",size:"lg",disabled:d,children:s?"Pause":"Play"}),e.jsx(C,{onClick:x,variant:"outline",size:"lg",disabled:d,children:d?"Downloading...":"Download"})]})]})]})]})}):null};function ft(t,r=[]){let n=[];function o(c,d){const i=l.createContext(d),a=n.length;n=[...n,d];function x(h){const{scope:u,children:g,...b}=h,S=(u==null?void 0:u[t][a])||i,P=l.useMemo(()=>b,Object.values(b));return e.jsx(S.Provider,{value:P,children:g})}function m(h,u){const g=(u==null?void 0:u[t][a])||i,b=l.useContext(g);if(b)return b;if(d!==void 0)return d;throw new Error(`\`${h}\` must be used within \`${c}\``)}return x.displayName=c+"Provider",[x,m]}const s=()=>{const c=n.map(d=>l.createContext(d));return function(i){const a=(i==null?void 0:i[t])||c;return l.useMemo(()=>({[`__scope${t}`]:{...i,[t]:a}}),[i,a])}};return s.scopeName=t,[o,bt(s,...r)]}function bt(...t){const r=t[0];if(t.length===1)return r;const n=()=>{const o=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(c){const d=o.reduce((i,{useScope:a,scopeName:x})=>{const h=a(c)[`__scope${x}`];return{...i,...h}},{});return l.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}var ae="Progress",le=100,[vt,Tt]=ft(ae),[jt,yt]=vt(ae),Ie=l.forwardRef((t,r)=>{const{__scopeProgress:n,value:o=null,max:s,getValueLabel:c=wt,...d}=t;(s||s===0)&&!ue(s)&&console.error(St(`${s}`,"Progress"));const i=ue(s)?s:le;o!==null&&!me(o,i)&&console.error(Nt(`${o}`,"Progress"));const a=me(o,i)?o:null,x=V(a)?c(a,i):void 0;return e.jsx(jt,{scope:n,value:a,max:i,children:e.jsx(T.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":V(a)?a:void 0,"aria-valuetext":x,role:"progressbar","data-state":Ue(a,i),"data-value":a??void 0,"data-max":i,...d,ref:r})})});Ie.displayName=ae;var De="ProgressIndicator",ze=l.forwardRef((t,r)=>{const{__scopeProgress:n,...o}=t,s=yt(De,n);return e.jsx(T.div,{"data-state":Ue(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...o,ref:r})});ze.displayName=De;function wt(t,r){return`${Math.round(t/r*100)}%`}function Ue(t,r){return t==null?"indeterminate":t===r?"complete":"loading"}function V(t){return typeof t=="number"}function ue(t){return V(t)&&!isNaN(t)&&t>0}function me(t,r){return V(t)&&!isNaN(t)&&t<=r&&t>=0}function St(t,r){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${le}\`.`}function Nt(t,r){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${le} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var He=Ie,Ct=ze;const Z=l.forwardRef(({className:t,value:r,...n},o)=>e.jsx(He,{ref:o,className:ee("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:e.jsx(Ct,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));Z.displayName=He.displayName;const j=fe.memo(({title:t,icon:r,children:n,className:o=""})=>e.jsxs(J,{className:o,children:[e.jsx(Q,{children:e.jsxs(be,{className:"text-base flex items-center space-x-2",children:[r,e.jsx("span",{children:t})]})}),e.jsx(K,{children:n})]})),Pt=({open:t,onClose:r,analysis:n,callData:o})=>{var i,a,x,m,h;const s=l.useMemo(()=>{if(!n)return null;try{return typeof n=="string"?JSON.parse(n):n}catch(u){return console.error("Error parsing analysis:",u),null}},[n]);if(!s)return null;const c=l.useCallback(u=>u>=71?"text-green-600 bg-green-50":u>=51?"text-yellow-600 bg-yellow-50":u>=31?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",[]),d=l.useCallback(u=>{switch(u){case"Hot":return"bg-red-100 text-red-800";case"Warm":return"bg-yellow-100 text-yellow-800";case"Cold":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},[]);return e.jsx(xe,{open:t,onOpenChange:r,children:e.jsxs(he,{className:"max-w-6xl max-h-[90vh]",children:[e.jsx(ge,{children:e.jsxs(pe,{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-5 h-5"}),e.jsx("span",{children:"AI Lead Analysis & Persuasion Strategy"})]})}),e.jsx(Y,{className:"h-[calc(90vh-120px)]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[e.jsxs(j,{title:"Lead Score & Classification",icon:e.jsx(F,{className:"w-4 h-4"}),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 px-4 py-2 rounded-lg ${c(s.leadScore)}`,children:[s.leadScore,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overall Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:d(s.qualificationStatus),children:s.qualificationStatus}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Qualification Status"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(E,{variant:s.sentiment==="Positive"?"default":"secondary",children:s.sentiment}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Sentiment"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Lead Score"}),e.jsxs("span",{children:[s.leadScore,"%"]})]}),e.jsx(Z,{value:s.leadScore,className:"h-3"})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsxs(E,{variant:"outline",className:"bg-blue-50",children:["Analysis by: ",s.analyzerUsed==="openai"?"OpenAI GPT-4":"Basic Analyzer"]}),s.openAIError&&e.jsxs("div",{className:"mt-2 text-xs text-red-600 bg-red-50 px-2 py-1 rounded",children:["OpenAI Error: ",s.openAIError.message]})]})]}),s.detailedSummary&&e.jsx(j,{title:"Detailed Conversation Analysis",icon:e.jsx(G,{className:"w-4 h-4 text-blue-600"}),className:"border-blue-200 bg-blue-50/30",children:e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:s.detailedSummary})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.psychologyProfile&&e.jsxs(j,{title:"Psychology Profile",icon:e.jsx(Xe,{className:"w-4 h-4 text-purple-600"}),className:"border-purple-200 bg-purple-50/30",children:[e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:s.psychologyProfile}),s.communicationStyle&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Communication Style:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.communicationStyle})]})]}),s.persuasionStrategy&&e.jsx(j,{title:"Persuasion Strategy",icon:e.jsx(ce,{className:"w-4 h-4 text-green-600"}),className:"border-green-200 bg-green-50/30",children:e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:s.persuasionStrategy})})]}),((i=s.objections)==null?void 0:i.length)>0&&e.jsx(j,{title:"Objections & Handling Strategies",icon:e.jsx(F,{className:"w-4 h-4 text-orange-600"}),className:"border-orange-200 bg-orange-50/30",children:e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-orange-700 mb-2",children:"Objections Raised:"}),e.jsxs("ul",{className:"space-y-1",children:[s.objections.slice(0,10).map((u,g)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-400 rounded-full mt-2 mr-2 flex-shrink-0"}),u]},g)),s.objections.length>10&&e.jsxs("li",{className:"text-xs text-gray-500",children:["+",s.objections.length-10," more objections"]})]})]}),((a=s.objectionHandling)==null?void 0:a.length)>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-orange-700 mb-2",children:"Handling Strategies:"}),e.jsxs("ul",{className:"space-y-1",children:[s.objectionHandling.slice(0,10).map((u,g)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start",children:[e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full mt-2 mr-2 flex-shrink-0"}),u]},g)),s.objectionHandling.length>10&&e.jsxs("li",{className:"text-xs text-gray-500",children:["+",s.objectionHandling.length-10," more strategies"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[((x=s.persuasionTactics)==null?void 0:x.length)>0&&e.jsx(j,{title:"Persuasion Tactics",icon:e.jsx(qe,{className:"w-4 h-4"}),children:e.jsxs("div",{className:"space-y-2",children:[s.persuasionTactics.slice(0,8).map((u,g)=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-blue-50 rounded",children:[e.jsx(ce,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"text-sm",children:u})]},g)),s.persuasionTactics.length>8&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.persuasionTactics.length-8," more tactics"]})]})}),((m=s.talkingPoints)==null?void 0:m.length)>0&&e.jsx(j,{title:"Key Talking Points",icon:e.jsx(G,{className:"w-4 h-4"}),children:e.jsxs("div",{className:"space-y-2",children:[s.talkingPoints.slice(0,8).map((u,g)=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-green-50 rounded",children:[e.jsx("span",{className:"w-5 h-5 bg-green-600 text-white text-xs rounded-full flex items-center justify-center font-medium mt-0.5",children:g+1}),e.jsx("span",{className:"text-sm",children:u})]},g)),s.talkingPoints.length>8&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.talkingPoints.length-8," more points"]})]})})]}),s.followUpRecommendations&&e.jsx(j,{title:"Follow-up Strategy",icon:e.jsx(Ye,{className:"w-4 h-4 text-indigo-600"}),className:"border-indigo-200 bg-indigo-50/30",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-indigo-700",children:"Timing:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.followUpRecommendations.timing})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-indigo-700",children:"Channel:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.followUpRecommendations.channel})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-indigo-700",children:"Approach:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.followUpRecommendations.approach})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{title:"Interest & Authority",icon:e.jsx(F,{className:"w-4 h-4 text-purple-600"}),className:"border-purple-200 bg-purple-50/30",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-purple-700 mb-2",children:"Interest Level"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{value:(s.interestLevel||0)*10,className:"h-2"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.interestLevel||0,"/10"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-purple-700 mb-2",children:"Decision Authority"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.decisionAuthority||"Unknown"})]})]})}),e.jsx(j,{title:"Timeline & Budget",icon:e.jsx(oe,{className:"w-4 h-4"}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Timeline:"}),e.jsx(E,{variant:"outline",className:"ml-2",children:s.timelineUrgency||s.timeline||"Not specified"})]}),((h=s.budgetIndicators)==null?void 0:h.length)>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Budget Signals:"}),e.jsx("div",{className:"mt-1 space-y-1",children:s.budgetIndicators.slice(0,2).map((u,g)=>e.jsx("div",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:u},g))})]})]})})]}),e.jsx(j,{title:"Timeline & Next Steps",icon:e.jsx(oe,{className:"w-4 h-4 text-green-600"}),className:"border-green-200 bg-green-50/30",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"Timeline"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.timeline||"Not specified in conversation"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"Recommended Next Action"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.nextBestAction||"No specific recommendation available"})]})]})}),s.summary&&!s.detailedSummary&&e.jsx(j,{title:"AI Summary",icon:e.jsx(G,{className:"w-4 h-4"}),children:e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:s.summary})})]})})]})})},M=10,At=fe.memo(({call:t,onViewTranscript:r,onPlayRecording:n,onViewAIAnalysis:o,triggerAIAnalysis:s,getScoreColor:c,getQualificationColor:d,isAnalyzing:i})=>{var x;const a=l.useMemo(()=>{if(!t.ai_analysis)return null;try{return typeof t.ai_analysis=="string"?JSON.parse(t.ai_analysis):t.ai_analysis}catch(m){return console.error("Error parsing AI analysis:",m),null}},[t.ai_analysis]);return e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ve,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.phone_number}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsx("span",{children:t.created_at?new Date(t.created_at).toLocaleString():"Unknown time"}),t.duration&&e.jsxs("span",{children:[Math.round(t.duration/60)," min"]}),t.outcome&&e.jsx("span",{className:"capitalize",children:t.outcome})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(E,{variant:t.status==="completed"?"default":t.status==="pending"?"secondary":t.status==="in_progress"?"default":"destructive",children:t.status.replace("_"," ")}),e.jsxs("div",{className:"flex space-x-2",children:[t.transcript&&e.jsx(C,{size:"sm",variant:"outline",onClick:()=>r(t),children:e.jsx(Fe,{className:"w-4 h-4"})}),t.recording_url&&e.jsx(C,{size:"sm",variant:"outline",onClick:()=>n(t),children:e.jsx(Ge,{className:"w-4 h-4"})})]})]})]}),t.status==="completed"&&e.jsx("div",{className:"border-t pt-4",children:i(t)?e.jsxs("div",{className:"flex items-center justify-center py-4 text-gray-500",children:[e.jsx(ie,{className:"w-4 h-4 animate-spin mr-2"}),e.jsx("span",{children:"Analyzing transcript..."})]}):t.ai_analysis?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"AI Analysis"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>{t.transcript&&s(t.id,t.transcript)},className:"text-blue-600 border-blue-200 hover:bg-blue-50",disabled:!t.transcript||i(t),children:i(t)?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 animate-spin mr-2"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Reanalyze"]})}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>o(t),className:"text-purple-600 border-purple-200 hover:bg-purple-50",children:"View Full Report"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold mb-1 px-3 py-1 rounded-lg ${c(t.lead_score)}`,children:[t.lead_score||0,"/100"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Lead Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:d(t.qualification_status),children:t.qualification_status||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Status"})]}),(a==null?void 0:a.interestLevel)&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:[a.interestLevel,"/10"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Interest"})]}),(a==null?void 0:a.sentiment)&&e.jsxs("div",{className:"text-center",children:[e.jsx(E,{variant:a.sentiment==="Positive"?"default":"secondary",children:a.sentiment}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sentiment"})]})]}),((x=a==null?void 0:a.keyInsights)==null?void 0:x.length)>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Key Insights"}),e.jsxs("div",{className:"space-y-1",children:[a.keyInsights.slice(0,2).map((m,h)=>e.jsxs("div",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:["â€¢ ",m]},h)),a.keyInsights.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",a.keyInsights.length-2," more insights"]})]})]}),(a==null?void 0:a.nextBestAction)&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Recommended Action"}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-2",children:e.jsx("p",{className:"text-xs text-green-800",children:a.nextBestAction})})]})]}):t.transcript?e.jsx("div",{className:"flex items-center justify-center py-4 text-gray-500",children:e.jsx("span",{children:"Analysis will be available shortly..."})}):e.jsx("div",{className:"flex items-center justify-center py-4 text-gray-400",children:e.jsx("span",{children:"No transcript available for analysis"})})})]})}),Lt=()=>{const{data:t=[],isLoading:r,refetch:n}=Qe(),o=Ke(),[s,c]=l.useState(null),[d,i]=l.useState(null),[a,x]=l.useState(null),[m,h]=l.useState(1),u=Math.ceil(t.length/M),g=l.useMemo(()=>{const p=(m-1)*M;return t.slice(p,p+M)},[t,m]),b=l.useCallback(p=>p?p>=71?"bg-green-100 text-green-800":p>=51?"bg-yellow-100 text-yellow-800":p>=31?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800":"bg-gray-100 text-gray-600",[]),S=l.useCallback(p=>{switch(p){case"Hot":return"bg-red-500 text-white";case"Warm":return"bg-yellow-500 text-white";case"Cold":return"bg-blue-500 text-white";case"Unqualified":return"bg-gray-500 text-white";default:return"bg-gray-300 text-gray-700"}},[]),P=l.useCallback(p=>p.status==="completed"&&p.transcript&&!p.ai_analysis,[]),N=l.useCallback(p=>{c(p),i("transcript")},[]),L=l.useCallback(p=>{c(p),i("recording")},[]),O=l.useCallback(()=>{c(null),i(null)},[]),k=l.useCallback(p=>{try{const f=typeof p.ai_analysis=="string"?JSON.parse(p.ai_analysis):p.ai_analysis,v={leadScore:p.lead_score||f.leadScore||0,qualificationStatus:p.qualification_status||f.qualificationStatus||"Unqualified",sentiment:f.sentiment||"Neutral",detailedSummary:f.detailedSummary||"",keyInsights:f.keyInsights||[],followUpActions:f.followUpActions||[],persuasionStrategy:f.persuasionStrategy||"",psychologyProfile:f.psychologyProfile||"",communicationStyle:f.communicationStyle||"",objections:f.objections||[],objectionHandling:f.objectionHandling||[],persuasionTactics:f.persuasionTactics||[],interestLevel:f.interestLevel||0,decisionAuthority:f.decisionAuthority||"Unknown",timeline:f.timeline||"Not specified",nextBestAction:f.nextBestAction||"No specific recommendation available",analyzerUsed:p.analyzer_used||f.analyzerUsed||"unknown",openAIError:f.openAIError||null};x({...p,ai_analysis:v})}catch(f){console.error("Error parsing AI analysis:",f),x({...p,ai_analysis:{leadScore:p.lead_score||0,qualificationStatus:p.qualification_status||"Unqualified",sentiment:"Neutral",detailedSummary:"",keyInsights:[],followUpActions:[],persuasionStrategy:"",psychologyProfile:"",communicationStyle:"",objections:[],objectionHandling:[],persuasionTactics:[],interestLevel:0,decisionAuthority:"Unknown",timeline:"Not specified",nextBestAction:"No specific recommendation available",analyzerUsed:p.analyzer_used||"unknown",openAIError:null}})}},[]),I=l.useCallback(()=>{x(null)},[]),A=l.useCallback(()=>{m<u&&h(p=>p+1)},[m,u]),D=l.useCallback(()=>{m>1&&h(p=>p-1)},[m]);return r?e.jsxs("div",{className:"space-y-6 min-h-[400px]",children:[e.jsx("div",{className:"h-8 w-48 bg-gray-200 rounded animate-pulse"}),e.jsxs(J,{className:"animate-pulse",children:[e.jsxs(Q,{children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded"})]}),e.jsx(K,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((p,f)=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},f))})})]})]}):e.jsxs("div",{className:"space-y-6 min-h-[600px]",children:[e.jsx("div",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 pb-4 border-b border-border/40",children:e.jsxs("div",{className:"p-2",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Call History"}),e.jsx("p",{className:"text-gray-600",children:"View and manage all AI phone calls with automatic AI-powered lead scoring"})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(be,{children:"Recent Calls"}),e.jsx(Ze,{children:"All AI phone calls made through Bland.ai with automatic lead qualification analysis"})]}),t.length>M&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:D,disabled:m===1,children:e.jsx(et,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm",children:["Page ",m," of ",u]}),e.jsx(C,{variant:"outline",size:"sm",onClick:A,disabled:m===u,children:e.jsx(tt,{className:"w-4 h-4"})})]})]})}),e.jsx(K,{children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No calls made yet"}),e.jsx("p",{className:"text-gray-600",children:"Start a campaign to begin making AI phone calls to your leads"})]}):e.jsx(Y,{className:"h-[600px]",children:e.jsx("div",{className:"space-y-4 pr-4",children:g.map(p=>e.jsx(At,{call:p,onViewTranscript:N,onPlayRecording:L,onViewAIAnalysis:k,triggerAIAnalysis:o,getScoreColor:b,getQualificationColor:S,isAnalyzing:P},p.id))})})})]})}),e.jsx(pt,{open:!!s&&!!d,onClose:O,call:s,view:d}),e.jsx(Pt,{open:!!a,onClose:I,analysis:a==null?void 0:a.ai_analysis,callData:a})]})};export{Lt as BlandAICalls};
